{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://workagent.example.com/schemas/system/validated_inputs_v1.schema.json",
  "title": "Validated Inputs v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_version", "inputs", "resolved_options"],
  "properties": {
    "schema_version": { "type": "string", "const": "validated_inputs_v1" },

    "inputs": {
      "type": "object",
      "additionalProperties": false,
      "required": ["prompt", "file_ids", "template_id", "brand_kit_id"],
      "properties": {
        "prompt": { "type": "string", "minLength": 1, "maxLength": 20000 },
        "language": { "type": "string", "minLength": 2, "maxLength": 20 },
        "audience": { "type": "string", "maxLength": 200 },
        "tone": { "type": "string", "maxLength": 200 },

        "file_ids": {
          "type": "array",
          "minItems": 0,
          "maxItems": 200,
          "items": { "type": "string", "minLength": 1, "maxLength": 120 }
        },

        "template_id": { "type": "string", "minLength": 1, "maxLength": 120 },
        "brand_kit_id": { "type": "string", "minLength": 1, "maxLength": 120 }
      }
    },

    "resolved_options": {
      "type": "object",
      "additionalProperties": false,
      "required": ["slide_count", "require_outline_approval", "include_citations", "allow_external_web", "slide_size"],
      "properties": {
        "slide_count": { "type": "integer", "minimum": 1, "maximum": 200 },
        "require_outline_approval": { "type": "boolean" },
        "include_citations": { "type": "boolean" },
        "allow_external_web": { "type": "boolean" },
        "slide_size": { "type": "string", "maxLength": 80 }
      }
    },

    "normalized": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "language": { "type": "string", "minLength": 2, "maxLength": 20 },
        "prompt_sha256": { "type": "string", "minLength": 16, "maxLength": 128 }
      }
    },

    "validated_at": { "type": "string", "format": "date-time" },

    "extensions": { "type": "object" }
  }
}
